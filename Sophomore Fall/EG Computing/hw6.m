% 901965168
% Chris Kreienkamp
% Homework 6

clear
clc
clf

%% SET VARIABLES

N = 6;
a = -1;
b = 1;
x = linspace(a,b,10000);
dx = (b-a)/N;
for i = 1:N+1
    xest(i) = a+dx*(i-1);
end
%           y(x)                       y'(x)                        y''(x)
yfortran = [  6.73794699908546700E-003 -0.24074275327065875        4.1803097056123555     
            0.10836802322189582       0.85052321060752090        2.3672860776567224     
            0.57375342073743274        1.3374479651671562       -1.2757848159112806     
            1.0000000000000000       4.44089209850062616E-016  -4.0123438955014681     
            0.57375342073743296       -1.3374479651671560       -1.2757848159112826     
            0.10836802322189595      -0.85052321060752134        2.3672860776567219     
            6.73794699908546700E-003  0.24074275327065844        4.1803097056123564 ];
yest = yfortran(:,1);
ydotest = yfortran(:,2);
ydotdotest = yfortran(:,3);
        
% Exact Solution
ydot = -10*x.*exp(-5*x.^2);
ydotdot = -10*(1-10*x.^2).*exp(-5*x.^2);

%% PLOT

% y'(x)
figure(1)
plot(xest,ydotest,'ro',x,ydot,'b-')
     xlabel('x','FontSize',24),...
     ylabel('y''(x)','FontSize',24),...
     axis([-1 1 -2 2]),...
     set(gca,'FontSize',17)
     legend('Estimate','Exact Solution','Location','Northeast')

% y''(x)
figure(2)
plot(xest,ydotdotest,'ro',x,ydotdot,'b-')
    yticks([-10,-7.5,-5,-2.5,0,2.5,5])
     xlabel('x','FontSize',24),...
     ylabel('y''''(x)','FontSize',24),...
     axis([-1 1 -10 5]),...
     set(gca,'FontSize',17)
     legend('Estimate','Exact Solution','Location','Southeast')
 
% Error
figure(3)
fortranerror = [0.33333333333333331        5.9876561
0.20000000000000001        3.1166120
0.10000000000000001       0.93653768
6.66666666666666657E-002  0.43156323
5.00000000000000028E-002  0.24588490
4.00000000000000008E-002  0.15830690
3.33333333333333329E-002  0.11029262
2.85714285714285705E-002  8.11901987E-02
2.50000000000000014E-002  6.22403957E-02
2.22222222222222231E-002  4.92205396E-02
2.00000000000000004E-002  3.98935452E-02
1.33333333333333342E-002  1.77567266E-02
1.00000000000000002E-002  9.99333709E-03
8.00000000000000017E-003  6.39727013E-03
6.66666666666666709E-003  4.44312766E-03
5.71428571428571428E-003  3.26459552E-03
5.00000000000000010E-003  2.49958341E-03
4.44444444444444444E-003  1.97504857E-03
4.00000000000000008E-003  1.59982929E-03
3.63636363636363636E-003  1.32219750E-03
3.33333333333333355E-003  1.11102883E-03
3.07692307692307692E-003  9.46685788E-04
2.85714285714285714E-003  8.16282118E-04
2.66666666666666658E-003  7.11077417E-04
2.50000000000000005E-003  6.24973967E-04
2.35294117647058803E-003  5.53612772E-04
2.22222222222222222E-003  4.93810920E-04
2.10526315789473679E-003  4.43200202E-04
2.00000000000000004E-003  3.99989338E-04
1.81818181818181818E-003  3.30571231E-04
1.66666666666666677E-003  2.77772633E-04];
 
loglog(fortranerror(:,1),fortranerror(:,2),'mo')
     xlabel('\Deltax','FontSize',24),...
     ylabel('Error in y''''(0)','FontSize',24),...
     set(gca,'FontSize',20)
