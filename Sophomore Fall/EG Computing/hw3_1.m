% 901965168
% Chris Kreienkamp
% Homework 3, Problem 1

clear
clc
clf

%% SET VARIABLES

% Exact Solution
yExact = [1.0000000 0.90483743 0.81873077 0.74081820 0.67032003...
    0.60653067 0.54881161 0.49658531 0.44932896 0.40656966 0.36787945];
 
eulerMassSpring= [0.0000000       2.0000000       2.0000000    
  1.99999996E-02   2.0000000       1.9964011    
  3.99999991E-02   1.9928000       1.9856173    
  5.99999987E-02   1.9784000       1.9676874    
  7.99999982E-02   1.9568260       1.9426759    
  9.99999940E-02   1.9281297       1.9106730    
  0.12000000       1.8923888       1.8717937    
  0.14000000       1.8497066       1.8261778    
  0.16000000       1.8002119       1.7739898    
  0.17999999       1.7440583       1.7154174    
  0.19999999       1.6814238       1.6506712    
  0.22000000       1.6125107       1.5799845    
  0.23999999       1.5375445       1.5036114    
  0.25999999       1.4567733       1.4218271    
  0.28000000       1.3704668       1.3349255    
  0.29999998       1.2789160       1.2432200    
  0.31999999       1.1824316       1.1470400    
  0.34000000       1.0813431       1.0467319    
  0.35999998      0.97599775      0.94265687    
  0.38000000      0.86675960      0.83518904    
  0.39999998      0.75400782      0.72471565    
  0.41999999      0.63813573      0.61163384    
  0.44000000      0.51954925      0.49635103    
  0.45999998      0.39866546      0.37928191    
  0.47999999      0.27591127      0.26084754    
  0.50000000      0.15172191      0.14147440    
  0.51999998      2.65392661E-02  2.15923488E-02
  0.53999996     -9.91895795E-02 -9.83674154E-02
  0.56000000     -0.22501396     -0.21797363    
  0.57999998     -0.35048127     -0.33679491    
  0.59999996     -0.47513852     -0.45440409    
  0.62000000     -0.59853405     -0.57037812    
  0.63999999     -0.72021908     -0.68429923    
  0.65999997     -0.83974934     -0.79575759    
  0.68000001     -0.95668685     -0.90435225    
  0.69999999      -1.0706012      -1.0096921    
  0.71999997      -1.1810715      -1.1113980    
  0.74000001      -1.2876877      -1.2091045    
  0.75999999      -1.3900520      -1.3024592    
  0.77999997      -1.4877806      -1.3911265    
  0.79999995      -1.5805050      -1.4747872    
  0.81999999      -1.6678735      -1.5531406    
  0.83999997      -1.7495521      -1.6259041    
  0.85999995      -1.8252264      -1.6928160    
  0.88000000      -1.8946023      -1.7536356    
  0.89999998      -1.9574074      -1.8081441    
  0.91999996      -2.0133920      -1.8561451    
  0.94000000      -2.0623298      -1.8974663    
  0.95999998      -2.1040194      -1.9319586    
  0.97999996      -2.1382847      -1.9594978    
   1.0000000      -2.1649754      -1.9799850    
   1.0200000      -2.1839683      -1.9933463    
   1.0400000      -2.1951673      -1.9995338    
   1.0599999      -2.1985040      -1.9985250    
   1.0799999      -2.1939380      -1.9903239    
   1.1000000      -2.1814575      -1.9749595    
   1.1200000      -2.1610789      -1.9524875    
   1.1400000      -2.1328471      -1.9229887    
   1.1600000      -2.0968354      -1.8865693    
   1.1799999      -2.0531454      -1.8433602    
   1.1999999      -2.0019069      -1.7935170    
   1.2200000      -1.9432769      -1.7372189    
   1.2400000      -1.8774401      -1.6746688    
   1.2600000      -1.8046075      -1.6060917    
   1.2800000      -1.7250161      -1.5317346    
   1.3000000      -1.6389282      -1.4518648    
   1.3199999      -1.5466301      -1.3667699    
   1.3399999      -1.4484320      -1.2767565    
   1.3600000      -1.3446659      -1.1821470    
   1.3800000      -1.2356855      -1.0832838    
   1.4000000      -1.1218642     -0.98052198    
   1.4200000      -1.0035945     -0.87423134    
   1.4399999     -0.88128614     -0.76479441    
   1.4599999     -0.75536478     -0.65260506    
   1.4800000     -0.62627077     -0.53806609    
   1.5000000     -0.49445748     -0.42159161    
   1.5200000     -0.36038962     -0.30359983    
   1.5400000     -0.22454172     -0.18451543    
   1.5599999     -8.73964131E-02 -6.47669807E-02
   1.5799999      5.05572408E-02  5.52145652E-02
   1.5999999      0.18882553      0.17499740    
   1.6200000      0.32691181      0.29415137    
   1.6400000      0.46431834      0.41224578    
   1.6600000      0.60054797      0.52885652    
   1.6799999      0.73510605      0.64356399    
   1.6999999      0.86750215      0.75595528    
   1.7199999      0.99725187      0.86562604    
   1.7400000       1.1238786      0.97218221    
   1.7600000       1.2469152       1.0752380    
   1.7800000       1.3659059       1.1744257    
   1.8000000       1.4804076       1.2693852    
   1.8199999       1.5899920       1.3597777    
   1.8399999       1.6942471       1.4452752    
   1.8600000       1.7927781       1.5255725    
   1.8800000       1.8852099       1.6003788    
   1.9000000       1.9711877       1.6694254    
   1.9200000       2.0503788       1.7324640    
   1.9399999       2.1224735       1.7892674    
   1.9599999       2.1871870       1.8396316    
   1.9799999       2.2442594       1.8833750    
   2.0000000       2.2934580       1.9203405    
   2.0200000       2.3345773       1.9503947    
   2.0400000       2.3674402       1.9734296    
   2.0599999       2.3918986       1.9893622    
   2.0799999       2.4078343       1.9981353    
   2.0999999       2.4151590       1.9997172    
   2.1199999       2.4138155       1.9941025    
   2.1399999       2.4037774       1.9813111    
   2.1599998       2.3850496       1.9613891    
   2.1800001       2.3576682       1.9344079    
   2.2000000       2.3217006       1.9004649    
   2.2200000       2.2772455       1.8596829    
   2.2400000       2.2244322       1.8122073    
   2.2600000       2.1634209       1.7582107    
   2.2800000       2.0944016       1.6978854    
   2.3000000       2.0175939       1.6314507    
   2.3199999       1.9332464       1.5591433    
   2.3399999       1.8416356       1.4812260    
   2.3599999       1.7430651       1.3979764    
   2.3799999       1.6378647       1.3096972    
   2.3999999       1.5263892       1.2167029    
   2.4199998       1.4090174       1.1193314    
   2.4400001       1.2861507       1.0179291    
   2.4600000       1.1582115      0.91286498    
   2.4800000       1.0256422      0.80451548    
   2.5000000      0.88890326      0.69327062    
   2.5200000      0.74847203      0.57953078    
   2.5400000      0.60484076      0.46370521    
   2.5599999      0.45851499      0.34621081    
   2.5799999      0.31001177      0.22747043    
   2.5999999      0.15985790      0.10791142    
   2.6199999      8.58798623E-03 -1.20359724E-02
   2.6399999     -0.14325742     -0.13194004    
   2.6599998     -0.29513374     -0.25136927    
   2.6799998     -0.44649434     -0.36989290    
   2.7000000     -0.59679246     -0.48708904    
   2.7200000     -0.74548316     -0.60252845    
   2.7400000     -0.89202547     -0.71580130    
   2.7600000      -1.0358840     -0.82649618    
   2.7800000      -1.1765313     -0.93421835    
   2.8000000      -1.3134494      -1.0385766    
   2.8199999      -1.4461319      -1.1391988    
   2.8399999      -1.5740861      -1.2357196    
   2.8599999      -1.6968341      -1.3277946    
   2.8799999      -1.8139155      -1.4150895    
   2.8999999      -1.9248883      -1.4972930    
   2.9199998      -2.0293310      -1.5741067    
   2.9399998      -2.1268439      -1.6452564    
   2.9600000      -2.2170515      -1.7104849    
   2.9800000      -2.2996023      -1.7695574    
   3.0000000      -2.3741717      -1.8222605    
   3.0200000      -2.4404626      -1.8684056    
   3.0400000      -2.4982064      -1.9078271    
   3.0599999      -2.5471647      -1.9403825    
   3.0799999      -2.5871294      -1.9659541    
   3.0999999      -2.6179242      -1.9844505    
   3.1199999      -2.6394055      -1.9958053    
   3.1399999      -2.6514621      -1.9999772    
   3.1599998      -2.6540170      -1.9969513    
   3.1799998      -2.6470265      -1.9867388    
   3.1999998      -2.6304817      -1.9693760    
   3.2200000      -2.6044075      -1.9449253    
   3.2400000      -2.5688636      -1.9134749    
   3.2600000      -2.5239439      -1.8751388    
   3.2800000      -2.4697762      -1.8300534    
   3.3000000      -2.4065223      -1.7783827    
   3.3199999      -2.3343771      -1.7203108    
   3.3399999      -2.2535684      -1.6560485    
   3.3599999      -2.1643560      -1.5858254    
   3.3799999      -2.0670309      -1.5098960    
   3.3999999      -1.9619141      -1.4285315    
   3.4199998      -1.8493558      -1.3420272    
   3.4399998      -1.7297348      -1.2506917    
   3.4600000      -1.6034560      -1.1548548    
   3.4800000      -1.4709502      -1.0548617    
   3.5000000      -1.3326720     -0.95107388    
   3.5200000      -1.1890984     -0.84386325    
   3.5400000      -1.0407270     -0.73361391    
   3.5599999     -0.88807499     -0.62072432    
   3.5799999     -0.73167634     -0.50560260    
   3.5999999     -0.57208061     -0.38866130    
   3.6199999     -0.40985084     -0.27031937    
   3.6399999     -0.24556157     -0.15100458    
   3.6599998     -7.97968358E-02 -3.11482307E-02
   3.6799998      8.68519098E-02  8.88202190E-02
   3.6999998      0.25378793      0.20847091    
   3.7200000      0.42041129      0.32737133    
   3.7400000      0.58612096      0.44509354    
   3.7600000      0.75031722      0.56121206    
   3.7800000      0.91240340      0.67531264    
   3.8000000       1.0717884      0.78698105    
   3.8199999       1.2278888      0.89581889    
   3.8399999       1.3801308       1.0014311    
   3.8599999       1.5279523       1.1034409    
   3.8799999       1.6708053       1.2014779    
   3.8999999       1.8081578       1.2951924    
   3.9199998       1.9394953       1.3842442    
   3.9399998       2.0643234       1.4683156    
   3.9599998       2.1821694       1.5471014    
   3.9800000       2.2925839       1.6203215    
   4.0000000       2.3951426       1.6877080]    

t = eulerMassSpring(:,1);
yApprox = eulerMassSpring(:,2);
yExact = eulerMassSpring(:,3);

%% PLOT

figure(1)
plot(t,yApprox,'r',t,yExact,'b')
    xlabel('t','FontSize',24),...
    ylabel('y(t)','FontSize',24),...
    %axis([0 4 0.3 1.05]),...
    set(gca,'FontSize',20)
    legend('Numerical Approximation','Exact Solution','Location','Northwest')
    
figure(2) % Error
error = [5.2084708 2.1742182 0.32804716 0.15786386 3.06154490E-02...
    1.52543783E-02 3.04305553E-03 1.52504444E-03 3.01837921E-04 1.54614449E-04...
    1.09314919E-04 6.10232353E-04 3.99267673E-02];
dt = [0.1 0.05 0.01 0.005 0.001...
    0.0005 0.0001 .00005 .00001 .000005...
    .000001 .0000005 1e-7]; 
loglog(dt,error,'ko')
    xlabel('\Deltat','FontSize',24),...
    ylabel('Error','FontSize',24),...
    set(gca,'FontSize',20)
