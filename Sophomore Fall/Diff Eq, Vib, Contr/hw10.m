% Chris Kreienkamp
% Wed Dec 6, 2017
% Diff Eq 1
% Homework 10

close all
clear all
clc


%% Problem 1 (12.1)

figure(1)
t_1 = linspace(0,10,10000);
x_1 = 1/26.*exp(-5*t_1)+5/26*sin(t_1)-1/26*cos(t_1);
dat1 = importdata('output1201_1.txt');
dat2 = importdata('output1201_2.txt');
dat3 = importdata('output1201_3.txt');
dat4 = importdata('output1201_5.txt');
plot(t_1,x_1,dat1(:,1),dat1(:,2),dat2(:,1),dat2(:,2),dat3(:,1),dat3(:,2),dat4(:,1),dat4(:,2))
legend('Exact Solution','\Delta t = 0.2','\Delta t = 0.1','\Delta t = 0.05','\Delta t = 0.01')
axis([0 5 -.2 0.2])
xlabel('t'); ylabel('x(t)')
set(gca,'FontSize',20)


%% Problem 2
data_2 = [  1.0000000000000000        88.964904904365540        73.653040930628777        173.75376238455709
   0.89999997615814209        78.945042046284229        40.047747137533406        133.65041427529556 
   0.80000001192092896        72.807205017394665        26.162632994173237        81.335772531701366  
  0.69999998807907104        61.473773386665357        2.6517061471606098        80.502435822635306     
  0.60000002384185791        56.879745563069875        2.8727316577428894        47.352669859100217     
  0.50000000000000000        40.097411222755909        23.329300627112389        62.584473192609522     
  0.40000000596046448        42.291749799504885        2.1460913661247503        20.767683346355255     
  0.30000001192092896        26.721393405264479        15.514174442049651        26.703575162106276     
  0.20000000298023224        22.490837113798989        5.4374660478862324        9.7560549731786494     
  0.10000000149011612        11.617734693351935        3.7022030841849869        4.7413997115334610   
  9.00000035762786865E-002   7.2138664824786929        7.3455966888504065        8.2189468532387195     
  7.99999982118606567E-002   6.0263671099592386        7.0262135816894613        7.7135776748879721     
  7.00000002980232239E-002   7.7981022731776619        3.2664783083699831        3.7723535252783194     
  5.99999986588954926E-002   6.2176633898769467        3.4002171042195926        3.7723140029575859     
  5.00000007450580597E-002   5.9050459705733260        2.0839383387369850        2.3387387399070860     
  3.99999991059303284E-002   2.9858679446514884        3.6065296655606858        3.7722900899154581     
  2.99999993294477463E-002   2.6804295620636083        2.2467652619290845        2.3387080780184704     
  1.99999995529651642E-002   1.4855488755561908        1.8252800076447784        1.8659870826755451     
  9.99999977648258209E-003  0.74085499025281365       0.91797828928982028       0.92807848671684212     
  8.99999961256980896E-003  0.71233225694811608       0.78006547580339713       0.78823698036460144     
  8.00000037997961044E-003  0.95786315286817114       0.36367369051211540       0.37010466765167394     
  7.00000021606683731E-003  0.70130416262773565       0.45792048830639942       0.46285428072906143     
  6.00000005215406418E-003  0.62735696191617762       0.36646043009645268       0.37008733856976050     
  4.99999988824129105E-003  0.36993953149348613       0.46030349181366148       0.46282960386812988     
  4.00000018998980522E-003  0.47954340048198674       0.18326213591767271       0.18488113476165324     
  3.00000002607703209E-003  0.26784061134976866       0.23021521325264871       0.23113257418523858     
  2.00000009499490261E-003  0.23991509235450792       9.19975152401093510E-002  9.24142472420896866E-002
  1.00000004749745131E-003  0.11998368255626701       4.60999073678181048E-002  4.62170796844389997E-002
  8.99999984540045261E-004  7.11300827416749826E-002  7.84251164945999335E-002  7.85227732397686395E-002
  7.99999979790300131E-004  5.91299552760204961E-002  7.38185220351255111E-002  7.38986854995715703E-002
  6.99999975040555000E-004  7.48039366215209611E-002  4.14940971048594065E-002  4.15599919614493274E-002
  6.00000028498470783E-004  6.27644202509713978E-002  3.69274969574178158E-002  3.69804518468868082E-002
  5.00000023748725653E-004  5.99879295256613432E-002  2.30856009667945727E-002  2.31271391726295406E-002
  3.99999989895150065E-004  2.95655640069014680E-002  3.69134707362235304E-002  3.69466724532969693E-002
  3.00000014249235392E-004  2.67561601790475834E-002  2.31012915552213371E-002  2.31273294499061421E-002
  1.99999994947575033E-004  1.47853352701474705E-002  1.84552251226079989E-002  1.84763680032915545E-002
  9.99999974737875164E-005  7.39613222789614611E-003  9.22464827775115737E-003  9.24267003534851028E-003
    9.00000013643875718E-005  7.10008164972464328E-003  7.85848528236954280E-003  7.87640562944602607E-003
  7.99999979790300131E-005  5.91819996013498439E-003  7.37840117474775070E-003  7.39608224407106718E-003
  7.00000018696300685E-005  5.61695106226522967E-003  6.01766979902151888E-003  6.03518429046800975E-003
  5.99999984842725098E-005  6.28668409746069301E-003  3.68557270191161024E-003  3.70298247344180709E-003
  4.99999987368937582E-005  3.70147328352743443E-003  4.60895337694466889E-003  4.62619143767994956E-003
  3.99999989895150065E-005  2.96265057006905863E-003  3.68565181234714601E-003  3.70296266832781384E-003
  2.99999992421362549E-005  2.68536153996024041E-003  2.30099298644859118E-003  2.31808928691634719E-003
  1.99999994947575033E-005  1.48484555600703061E-003  1.83931750494537027E-003  1.85647029090318938E-003
  9.99999974737875164E-006  7.45963911583658046E-004  9.16159707415431512E-004  9.33225193307407608E-004
  9.99999997475242708E-007  7.04851029809105967E-005  9.57347444341394294E-005  1.12796928519287576E-004];
dt = data_2(:,1);
figure(2)
loglog(dt,data_2(:,2),'b.-',dt,data_2(:,3),'r.-',dt,data_2(:,4),'g.-')
legend('Euler Method','2nd Order Runge-Kutta','4th Order Runge-Kutta','Location','Northwest')
xlabel('\Delta t'); ylabel('Error at t = 10')
set(gca,'FontSize',20)


%% Problem 3 (12.6)
dt_3a = importdata('outch1206a.txt');
dt_3b = importdata('outch1206b.txt');
dt_3c = importdata('outch1206c.txt');
dt_3d = importdata('outch1206d.txt');
dt_3e = importdata('outch1206e.txt');
dt_3f = importdata('outch1206f.txt');
dt_3g = importdata('outch1206g.txt');
dt_3h = importdata('outch1206h.txt');
dt_3p = importdata('outch1206p.txt');
dt_3q = importdata('outch1206q.txt');
dt_3r = importdata('outch1206r.txt');
dt_3s = importdata('outch1206s.txt');
dt_3t = importdata('outch1206t.txt');
dt_3u = importdata('outch1206u.txt');
dt_3v = importdata('outch1206v.txt');
dt_3w = importdata('outch1206w.txt');

figure(3)
t_3 = linspace(0,10,10000);
exact_3p = exp(-1/2*t_3).*(cos(sqrt(3)/2*t_3)+sqrt(3)/3*sin(sqrt(3)/2*t_3))-cos(t_3);
exact_3a = exp(-1/2*t_3).*(3.7-5*cos(sqrt(3)/2*t_3)+.00126486*sin(sqrt(3)/2*t_3))-3.7e-5*cos(30*t_3)-.00111*sin(30*t_3);

plot(dt_3p(:,1),dt_3p(:,2), dt_3q(:,1),dt_3q(:,2), dt_3r(:,1),dt_3r(:,2),...
    dt_3s(:,1),dt_3s(:,2), dt_3t(:,1),dt_3t(:,2), dt_3u(:,1),dt_3u(:,2),...
    dt_3v(:,1),dt_3v(:,2), dt_3w(:,1),dt_3w(:,2),t_3,exact_3p)
axis([0 8 -1.3 1.1])
xlabel('t'); ylabel('x(t)')
legend('\Delta t = 0.2','\Delta t = 0.175','\Delta t = 0.15',...
    '\Delta t = 0.125','\Delta t = 0.1','\Delta t = 0.05',...
    '\Delta t = 0.025','\Delta t = 0.0125','Exact','Location','Best')
set(gca,'FontSize',20)

figure(4)
plot(dt_3a(:,1),dt_3a(:,2), dt_3b(:,1),dt_3b(:,2), dt_3c(:,1),dt_3c(:,2),...
    dt_3d(:,1),dt_3d(:,2), dt_3e(:,1),dt_3e(:,2), dt_3f(:,1),dt_3f(:,2),...
    dt_3g(:,1),dt_3g(:,2), dt_3h(:,1),dt_3h(:,2),t_3,exact_3a)
xlabel('t'); ylabel('x(t)')
axis([0 10 -1.5 2])
legend('\Delta t = 0.2','\Delta t = 0.175','\Delta t = 0.15',...
    '\Delta t = 0.125','\Delta t = 0.1','\Delta t = 0.05',...
    '\Delta t = 0.025','\Delta t = 0.0125','Exact','Location','Best')
set(gca,'FontSize',20)


%% Problem 4

figure(5)
time_period = [-1 10];
initial = 1/(1+exp(40));
[t,x] = ode45(@ode45hw10, time_period, initial);
texact = linspace(-1,10,10000);
xexact = 1./(1+exp(-40*texact));
xerror = 1./(1+exp(-40*t));
plot(t,x,'o',texact,xexact,'-')
xlabel('t'); ylabel('x')
set(gca,'FontSize',20)
legend('ode45 Approximation','Exact Solution','Location','Southeast')

error = abs(xerror-x);
figure(6)
plot(t,error,'mo-')
xlabel('t'); ylabel('Error')
set(gca,'FontSize',20)
axis([-2 10.5 -0.02 1.02])

for i = 1:length(t)
    if error(i) == max(error)
        tfinal = t(i);
    end
end

% MATLAB does not give a good solution. As seen from the plot of the error,
% MATLAB is inconsistent and unpredictable with its deviation from the
% actual answer. The spike is due to MATLAB'S ode45() delay in following
% the shape of the actual graph.

figure(7)
dt_4 = [0.1, 0.09, 0.08, 0.07, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.009]; 
data_4 = [0.76378929006578966, 0.48948834517969220, 0.31254651603919814,...
0.12430408302791685, 4.61247218054805508E-003, 3.23011512951554280E-005,...
5.84665658887040252E-007, 1.82952743066344681E-007, 1.31840495187773854E-007,...
2.52892383700853429E-007, 1.98288021446835216E-007];
loglog(dt_4,data_4,'ro','Markersize',10,'Linewidth',3)
xlabel('\Delta t'); ylabel('Error at t = 0.368')
set(gca,'FontSize',20)
axis([5*10^-3 0.15 10^-8 1.1])


%% Problem 5





